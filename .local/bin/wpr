#!/bin/bash
# ┌──────────────────────────────────────────────────┐
# │           SIMPLE WALLPAPER SWITCHER (WPR)        │
# └──────────────────────────────────────────────────┘
# [INFO] This script changes the wallpaper from the main wallpaper directory
# [INFO] using a 'grow' transition effect.

# ┌──────────────────────────────────────────────────┐
# │                  1. CONFIGURATION                │
# └──────────────────────────────────────────────────┘

# [CONFIG] Path to your main wallpaper directory.
WALLPAPER_DIR="$HOME/Pictures/walls"

# ┌──────────────────────────────────────────────────┐
# │                   2. EXECUTION                   │
# └──────────────────────────────────────────────────┘

# --- Step 1: Validate Wallpaper Directory ---
# [INFO] Check if the configured directory exists.
if [ ! -d "$WALLPAPER_DIR" ]; then
  notify-send "Wallpaper Script Error" "Directory not found:\n$WALLPAPER_DIR" -i "dialog-error"
  exit 1
fi

# --- Step 2: Find a Random Image ---
# [INFO] Find a random image file from the top-level of the directory.
wallpaper=$(find "$WALLPAPER_DIR" -maxdepth 1 -type f \
  \( -iname "*.jpg" -o -iname "*.jpeg" -o -iname "*.png" -o -iname "*.gif" \) |
  shuf -n 1)

# --- Step 3: Validate Wallpaper Selection ---
# [INFO] Check if a wallpaper was found.
if [ -z "$wallpaper" ]; then
  notify-send "Wallpaper Script Error" "No images found in:\n$WALLPAPER_DIR" -i "dialog-error"
  exit 1
fi

# --- Step 4: Set the Wallpaper ---
# [INFO] Set the wallpaper using a custom 'grow' transition.
swww img "$wallpaper" \
  --transition-type grow \
  --transition-pos 0.5,0.5 \
  --transition-duration 1.2 \
  --transition-fps 60

# --- Step 5: Send Confirmation ---
# [INFO] Send a confirmation notification with the new wallpaper's name.
notify-send -t 500 " Wallpaper Changed" "$(basename "$wallpaper")" -i "preferences-desktop-wallpaper"
